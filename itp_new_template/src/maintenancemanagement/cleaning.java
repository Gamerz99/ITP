/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package maintenancemanagement;

import com.mysql.jdbc.Connection;
import dbconnect.dbconnect;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import javax.swing.JOptionPane;
import net.proteanit.sql.DbUtils;

/**
 *
 * @author Shihan
 */
public class cleaning extends javax.swing.JInternalFrame {
    String aa=null;
    Connection con =null;
    PreparedStatement pst =null;
    ResultSet rs = null;
    maintenanceclass m=new maintenanceclass();
    
    public cleaning() {
        initComponents();
        con=dbconnect.connect();
        viewtable();
    }
    
    public void viewtable()
    {
         String sqbuild="SELECT * FROM cleaning";
            
            try{
                    pst=con.prepareStatement(sqbuild);
                    pst.execute();
                    rs=pst.executeQuery();
                    cleaningtable.setModel(DbUtils.resultSetToTableModel(rs));
    
            }
            catch(Exception e){
                    JOptionPane.showConfirmDialog(null, e);
            }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jInternalFrame1 = new javax.swing.JInternalFrame();
        jInternalFrame2 = new javax.swing.JInternalFrame();
        jInternalFrame3 = new javax.swing.JInternalFrame();
        jScrollPane1 = new javax.swing.JScrollPane();
        cleaningtable = new javax.swing.JTable();
        jLabel2 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        rmno = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        type = new javax.swing.JComboBox<>();
        jLabel7 = new javax.swing.JLabel();
        stat = new javax.swing.JComboBox<>();
        jLabel9 = new javax.swing.JLabel();
        clndby = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        clndate = new com.toedter.calendar.JDateChooser();
        jLabel6 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        note = new javax.swing.JTextArea();
        printhk = new javax.swing.JButton();
        jButton1 = new javax.swing.JButton();
        updt = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();

        setBackground(new java.awt.Color(255, 255, 204));
        setMinimumSize(new java.awt.Dimension(1680, 940));
        setPreferredSize(new java.awt.Dimension(1680, 940));
        getContentPane().setLayout(null);

        javax.swing.GroupLayout jInternalFrame1Layout = new javax.swing.GroupLayout(jInternalFrame1.getContentPane());
        jInternalFrame1.getContentPane().setLayout(jInternalFrame1Layout);
        jInternalFrame1Layout.setHorizontalGroup(
            jInternalFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        jInternalFrame1Layout.setVerticalGroup(
            jInternalFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        getContentPane().add(jInternalFrame1);
        jInternalFrame1.setBounds(837, 452, 0, 0);

        javax.swing.GroupLayout jInternalFrame3Layout = new javax.swing.GroupLayout(jInternalFrame3.getContentPane());
        jInternalFrame3.getContentPane().setLayout(jInternalFrame3Layout);
        jInternalFrame3Layout.setHorizontalGroup(
            jInternalFrame3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        jInternalFrame3Layout.setVerticalGroup(
            jInternalFrame3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jInternalFrame2Layout = new javax.swing.GroupLayout(jInternalFrame2.getContentPane());
        jInternalFrame2.getContentPane().setLayout(jInternalFrame2Layout);
        jInternalFrame2Layout.setHorizontalGroup(
            jInternalFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
            .addGroup(jInternalFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jInternalFrame2Layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(jInternalFrame3, javax.swing.GroupLayout.PREFERRED_SIZE, 0, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        jInternalFrame2Layout.setVerticalGroup(
            jInternalFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
            .addGroup(jInternalFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jInternalFrame2Layout.createSequentialGroup()
                    .addGap(0, 0, Short.MAX_VALUE)
                    .addComponent(jInternalFrame3, javax.swing.GroupLayout.PREFERRED_SIZE, 0, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );

        getContentPane().add(jInternalFrame2);
        jInternalFrame2.setBounds(837, 452, 0, 0);

        cleaningtable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null}
            },
            new String [] {
                "RoomNo", "Type", "Status", "Note", "CleanedBy", "Date", "Time"
            }
        ));
        cleaningtable.setRowHeight(30);
        cleaningtable.setSelectionBackground(new java.awt.Color(0, 0, 0));
        cleaningtable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                cleaningtableMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(cleaningtable);

        getContentPane().add(jScrollPane1);
        jScrollPane1.setBounds(40, 70, 890, 420);

        jLabel2.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        jLabel2.setText("Cleaning Details");
        getContentPane().add(jLabel2);
        jLabel2.setBounds(1060, 10, 320, 30);

        jLabel4.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel4.setText("Room No :");
        getContentPane().add(jLabel4);
        jLabel4.setBounds(1060, 60, 120, 25);

        rmno.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        rmno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rmnoActionPerformed(evt);
            }
        });
        getContentPane().add(rmno);
        rmno.setBounds(1200, 50, 320, 40);

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel3.setText("Type :");
        getContentPane().add(jLabel3);
        jLabel3.setBounds(1060, 100, 120, 25);

        type.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        type.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "--------------------------------Select-------------------------------", "Deluxe", "Economy" }));
        getContentPane().add(type);
        type.setBounds(1200, 100, 320, 40);

        jLabel7.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel7.setText("Status :");
        getContentPane().add(jLabel7);
        jLabel7.setBounds(1060, 150, 120, 25);

        stat.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        stat.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "--------------------------------Select-------------------------------", "Cleaned", "Not Cleaned" }));
        getContentPane().add(stat);
        stat.setBounds(1200, 150, 320, 40);

        jLabel9.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel9.setText("Cleaned by :");
        getContentPane().add(jLabel9);
        jLabel9.setBounds(1060, 200, 120, 25);

        clndby.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        clndby.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clndbyActionPerformed(evt);
            }
        });
        getContentPane().add(clndby);
        clndby.setBounds(1200, 200, 320, 40);

        jLabel5.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel5.setText("Date/Time :");
        getContentPane().add(jLabel5);
        jLabel5.setBounds(1060, 250, 120, 25);
        getContentPane().add(clndate);
        clndate.setBounds(1200, 250, 320, 40);

        jLabel6.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel6.setText("Note : ");
        getContentPane().add(jLabel6);
        jLabel6.setBounds(1060, 300, 120, 25);

        note.setColumns(20);
        note.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        note.setRows(5);
        jScrollPane2.setViewportView(note);

        getContentPane().add(jScrollPane2);
        jScrollPane2.setBounds(1200, 300, 320, 140);

        printhk.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        printhk.setText("Print Housekeeping Details");
        getContentPane().add(printhk);
        printhk.setBounds(640, 20, 290, 40);

        jButton1.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Inventory/imgs/add.png"))); // NOI18N
        jButton1.setText("Add Entry");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton1);
        jButton1.setBounds(1200, 450, 130, 50);

        updt.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        updt.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Inventory/imgs/update.png"))); // NOI18N
        updt.setText("Update");
        updt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                updtActionPerformed(evt);
            }
        });
        getContentPane().add(updt);
        updt.setBounds(1390, 450, 130, 50);

        jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Maintenance/Images/body.jpg"))); // NOI18N
        jLabel1.setText("jLabel1");
        getContentPane().add(jLabel1);
        jLabel1.setBounds(-30, -10, 1620, 880);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void rmnoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rmnoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_rmnoActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        String roomno=rmno.getText();
        String ty=type.getSelectedItem().toString();       
        String status=stat.getSelectedItem().toString();
        String clean=clndby.getText();
        
        DateFormat df=new SimpleDateFormat("yyyy-MM-dd");
        
        
        String nt=note.getText();
        
        
        if(roomno.isEmpty()||ty.isEmpty()||status.isEmpty()||clean.isEmpty()||nt.isEmpty())
        {
           JOptionPane.showMessageDialog(null, "Information Required, Please fill!");
        }
        else{
        int x=JOptionPane.showConfirmDialog(null,"Add entry?");

        if(x==0)
        {
            Date clndt;
            clndt=clndate.getDate();
            String datecln=df.format(clndt);
            
            m.clnadd(roomno,ty,status,clean,datecln,nt);
            
        
        viewtable();
        type.setSelectedIndex(0);
        stat.setSelectedIndex(0);
        rmno.setText("");
        clndate.setDate(null);
        clndby.setText("");
        note.setText("");
        }
        }
    }//GEN-LAST:event_jButton1ActionPerformed

    private void clndbyActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_clndbyActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_clndbyActionPerformed

    private void cleaningtableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_cleaningtableMouseClicked
    try{
        int row=cleaningtable.getSelectedRow();//select items to the fields
        aa=cleaningtable.getModel().getValueAt(row, 0).toString();
        String a="select * from cleaning where EntryID='"+aa+"'";
        pst=con.prepareStatement(a);
        rs=pst.executeQuery();
        if(rs.next()){
            rmno.setText(rs.getString("RoomNo"));
            type.setSelectedItem(rs.getString("RoomType"));
            stat.setSelectedItem(rs.getString("Status"));
            clndby.setText(rs.getString("CleanedBy"));
            clndate.setDate(rs.getDate("Date"));
            note.setText(rs.getString("Note"));
        }
        }
                catch(Exception ex)
        {
            System.out.println(ex);
            //Logger.getLogger(vehiclerepair.class.getName()).log(Level.SEVERE,null,ex);
        }
    }//GEN-LAST:event_cleaningtableMouseClicked

    private void updtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_updtActionPerformed
        String roomnmbr=rmno.getText();
        String ty=type.getSelectedItem().toString();
        String status=stat.getSelectedItem().toString();
        String cleanedby=clndby.getText();
        
        DateFormat df=new SimpleDateFormat("yyyy-MM-dd");
        

        String nte=note.getText();
        
        if(roomnmbr.isEmpty()||ty.isEmpty()||status.isEmpty()||cleanedby.isEmpty()||nte.isEmpty()||df==null)
        {
           JOptionPane.showMessageDialog(null, "Information Required, Please fill!");
        }
        else{
        Date clndat;  
        clndat=clndate.getDate();
        String clndte=df.format(clndat);
            
        m.clnupdt(roomnmbr,ty,status,cleanedby,clndte,nte,aa);

        viewtable();
        rmno.setText("");
        type.setSelectedIndex(0);
        stat.setSelectedIndex(0);
        clndby.setText("");
        clndate.setDate(null);
        note.setText("");
        JOptionPane.showMessageDialog(null, "Entry Updated!");
        }
    }//GEN-LAST:event_updtActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable cleaningtable;
    private com.toedter.calendar.JDateChooser clndate;
    private javax.swing.JTextField clndby;
    private javax.swing.JButton jButton1;
    private javax.swing.JInternalFrame jInternalFrame1;
    private javax.swing.JInternalFrame jInternalFrame2;
    private javax.swing.JInternalFrame jInternalFrame3;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTextArea note;
    private javax.swing.JButton printhk;
    private javax.swing.JTextField rmno;
    private javax.swing.JComboBox<String> stat;
    private javax.swing.JComboBox<String> type;
    private javax.swing.JButton updt;
    // End of variables declaration//GEN-END:variables
}
